<!DOCTYPE html>

<html>

    <head>
        <meta charset="UTF-8" />
        <title>Create a Custom Widget - PhotonUI</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="shortcut icon" type="image/png" href="/PhotonUI/images/favicon.png" />
        <link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,700,300italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/PhotonUI/style/style.css" type="text/css">
        <script src="/PhotonUI/js/photonui.js" type="text/javascript"></script>
        <script src="/PhotonUI/js/highlight.pack.js" type="text/javascript"></script>
    </head>

    <body>

        <header>
    <div class="page">

        <div class="header-left">
            <img src="/PhotonUI/images/photonui-logo_white_300x300.png" alt="PhotonUI logo" />
        </div>

        <div class="header-right">
            <h1>PhotonUI</h1>
            <p>A javascript framework to create user interfaces</p>
            <nav class="nav">
                
                    <a href="/PhotonUI/">Home</a>
                
                    <a href="/PhotonUI/doc/">Documentation</a>
                
                    <a href="https://github.com/wanadev/PhotonUI">GitHub</a>
                
                    <a href="https://github.com/wanadev/PhotonUI/archive/master.zip">Download</a>
                
            </nav>
        </div>

    </div>
</header>


        <div id="content">
            

    <div class="demo-runner">
        <div class="page">
            <div class="left">
                
                    <h2>Create a Custom Widget</h2>
                
                <div id="demo"></div>
            </div>
            <div class="right">
                <div id="demo-error"></div>
                <script type="text/plain" id="demo-code-content">// Feel free to test some code here :)
</script>
                <div id="demo-code"></div>
                <button id="run-script"><i class="fa fa-play"></i> Run (Ctrl+Enter)</button>
            </div>
            <div style="clear: both;"></div>
        </div>
    </div>
    <script src="/PhotonUI/js/codemirror.js" type="text/javascript"></script>
    <script src="/PhotonUI/js/codemirror-mode-javascript.js" type="text/javascript"></script>
    <script src="/PhotonUI/js/script-runner.js" type="text/javascript"></script>


<div class="page">
    <article id="page-width-demo-undefined" class="article article-type-page-width-demo">
        <p>Creating a PhotonUI widget is not difficult, but you will need to learn a few things about how PhotonUI is built and works behind the scene, especially the Class system, the widgets hierarchy and the automagical functionality of the Base PhotonUI class (<a href="../ref/classes/photonui.Base.html"><code>photonui.Base</code></a>).</p>
<p>Also, I recommend you take a look at the <a href="../ref/">class reference documentation</a> and the existing widgets to have a better understanding of how widgets work.</p>
<h3 id="Abitbol-The-Heart-of-The-PhotonUI-Class-System"><a href="#Abitbol-The-Heart-of-The-PhotonUI-Class-System" class="headerlink" title="Abitbol: The Heart of The PhotonUI Class System"></a>Abitbol: The Heart of The PhotonUI Class System</h3><p><a href="https://github.com/wanadev/abitbol" target="_blank" rel="external">Abitbol</a> is a tiny javascript library that provides an handful (es5) class système.</p>
<h4 id="Dealing-With-Classes"><a href="#Dealing-With-Classes" class="headerlink" title="Dealing With Classes"></a>Dealing With Classes</h4><p>Declaring a class using Abitbol is very simple:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyClass = photonui.lib.Class.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">param1, param2</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Constructor code here...</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    myMethod: <span class="function"><span class="keyword">function</span>(<span class="params">param1, param2</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Code of myMethod here...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>… and using it is straightforward:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="keyword">new</span> MyClass(param1, param2);</span><br><span class="line">foo.myMethod(param1, param2);</span><br></pre></td></tr></table></figure>
<p>Extending an existing class is also simple:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MySecondClass = MyClass.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    myMethod: <span class="function"><span class="keyword">function</span>(<span class="params">param1, param2</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(param1, param2);  <span class="comment">// Call the myMethod of the parent class</span></span><br><span class="line">        <span class="comment">// Some more stuff...</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    mySecondMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Code for mySecondMethod...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Automagical-Properties"><a href="#Automagical-Properties" class="headerlink" title="Automagical Properties"></a>Automagical Properties</h4><p>Abitbol automatically creates properties from available getters and setters. To understand the principle, let’s study a simple example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = photonui.lib.Class.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    _firstName: <span class="string">""</span>,          <span class="comment">//  !!!!!!  NOTE¹</span></span><br><span class="line"></span><br><span class="line">    getFirstName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._firstName;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    setFirstName: <span class="function"><span class="keyword">function</span>(<span class="params">firstName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._firstName = firstName.toLocaleLowerCase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>There are many ways to get and set the <code>firstName</code> of the <code>Person</code> class:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// When instantiating the class</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(&#123;firstName: <span class="string">"Anakin"</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using getter and setter</span></span><br><span class="line">p.setFirstName(<span class="string">"Leia"</span>);</span><br><span class="line"><span class="keyword">var</span> name = p.getFirstName();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the automagically created property</span></span><br><span class="line">p.firstName = <span class="string">"Han"</span>;</span><br><span class="line"><span class="keyword">var</span> name = p.firstName;</span><br></pre></td></tr></table></figure>
<p><strong>NOTE¹:</strong> Pay attention to the underscore when we defined the <code>_firstName</code> attribute. Since the <code>firstName</code> property will be automatically created by the <a href="https://github.com/wanadev/abitbol" target="_blank" rel="external"><code>abitbol</code></a> class, you will create an infinite loop if you name your private property the same way.</p>
<h4 id="Going-Deeper-With-Abitbol"><a href="#Going-Deeper-With-Abitbol" class="headerlink" title="Going Deeper With Abitbol"></a>Going Deeper With Abitbol</h4><p>Abitbol provides a lot of other interesting functionalities like annotations, “mixin” and class vars… For more information <a href="https://github.com/wanadev/abitbol" target="_blank" rel="external">read the Abitbol documentation</a>.</p>
<h3 id="The-“photonui-Base”-Class"><a href="#The-“photonui-Base”-Class" class="headerlink" title="The “photonui.Base” Class"></a>The “photonui.Base” Class</h3><p>In PhotonUI, no widget directly extends the Abitbol’s <code>Class</code>. All widgets extend at least the <a href="../ref/classes/photonui.Base.html"><code>photonui.Base</code></a> class, and most often, the <a href="../ref/classes/photonui.Widget.html"><code>photonui.Widget</code></a> class.</p>
<h4 id="About-The-Constructor-Method"><a href="#About-The-Constructor-Method" class="headerlink" title="About The Constructor Method"></a>About The Constructor Method</h4><p>The constructor method of all PhotonUI widgets <strong>always</strong> calls the constructor method of the <a href="../ref/classes/photonui.Base.html"><code>photonui.Base</code></a> class, generally using the <code>this.$super(params)</code>. The constructor method of each widgets also <strong>always</strong> takes one argument: a parameter object that should be passed to the <a href="../ref/classes/photonui.Base.html"><code>photonui.Base</code></a> class constructor.</p>
<p>A simple example to understand:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyWidget = photonui.Widget.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line">        <span class="comment">// Your constructor code here...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Choosing-The-Right-Base-Class"><a href="#Choosing-The-Right-Base-Class" class="headerlink" title="Choosing The Right Base Class"></a>Choosing The Right Base Class</h3><p>When you create a PhotonUI widget, you will extend different classes depending on what kind of widget you want to create.</p>
<p>There are 5 main types of widgets in PhotonUI:</p>
<ul>
<li><p>For <strong>Interactive widgets</strong> (like <a href="widgets/button.html"><code>photonui.Button</code></a>, <a href="widgets/textfield.html"><code>photonui.TextField</code></a>,…) or <strong>Visual-Only widgets:</strong> (like <a href="widgets/faicon.html"><code>photonui.FAIcon</code></a>, <a href="widgets/label.html"><code>photonui.Label</code></a> or <a href="widgets/separator.html"><code>photonui.Separator</code></a>), you will generally extend the <a href="../ref/classes/photonui.Widget.html"><code>photonui.Widget</code></a> class,</p>
</li>
<li><p>for <strong>Non-Visual widgets</strong> (like <a href="widgets/translation.html"><code>photonui.Translation</code></a>, <a href="widgets/filemanager.html"><code>photonui.FileManager</code></a> or <a href="widgets/mousemanager.html"><code>photonui.MouseManager</code></a>), you will extend the <a href="../ref/classes/photonui.Base.html"><code>photonui.Base</code></a> class,</p>
</li>
<li><p>for <strong>Container widgets</strong> (like <a href="widgets/window.html"><code>photonui.Window</code></a> or <a href="widgets/menuitem.html"><code>photonui.MenuItem</code></a>), you will probably extend the <a href="../ref/classes/photonui.Container.html"><code>photonui.Container</code></a> class,</p>
</li>
<li><p>and for <strong>Layout widgets</strong> (like <a href="widgets/boxlayout.html"><code>photonui.BoxLayout</code></a> or <a href="widgets/gridlayout.html"><code>photonui.GridLayout</code></a>) you should extend the <a href="../ref/classes/photonui.Layout.html"><code>photonui.Layout</code></a> class.</p>
</li>
</ul>
<p>Of course, if you want to build a more specific widget, you can extend more specialized classes.</p>
<h3 id="Minimal-Widget-Templates"><a href="#Minimal-Widget-Templates" class="headerlink" title="Minimal Widget Templates"></a>Minimal Widget Templates</h3><p>Depending on what kind of widget you want to create, you will inherit from different classes, and you will have to define different methods to make things work.</p>
<h4 id="Template-for-“Non-Visual”-Widgets"><a href="#Template-for-“Non-Visual”-Widgets" class="headerlink" title="Template for “Non-Visual” Widgets"></a>Template for “Non-Visual” Widgets</h4><p>Non-visual widgets have no specific method to override to make things work:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyWidget = photonui.Base.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your methods and attributes here</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>You can however override the <code>destroy</code> method if it is relevant:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">destroy: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Clean things here...</span></span><br><span class="line">    <span class="keyword">this</span>.$<span class="keyword">super</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Template-for-“Interactive”-and-“Visual-Only”-Widgets"><a href="#Template-for-“Interactive”-and-“Visual-Only”-Widgets" class="headerlink" title="Template for “Interactive” and “Visual-Only” Widgets"></a>Template for “Interactive” and “Visual-Only” Widgets</h4><p>For interactive and visual widgets, you should at least implement the <code>getHtml</code> and the <code>_buildHtml</code> methods:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyWidget = photonui.Widget.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line">        <span class="comment">// Widget constructor...</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Return the outer HTML element of the widget</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.__html.div;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _buildHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// We build the widget's HTML in this method.</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// All the HTML nodes go in the "this.__html" object</span></span><br><span class="line">        <span class="keyword">this</span>.__html.div = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// All PhotonUI Widget have the "photonui-wiget" class on their</span></span><br><span class="line">        <span class="comment">// outer HTML elements</span></span><br><span class="line">        <span class="keyword">this</span>.__html.div.className = <span class="string">"photonui-widget photonui-mywidget"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Template-for-“Container”-Widgets"><a href="#Template-for-“Container”-Widgets" class="headerlink" title="Template for “Container” Widgets"></a>Template for “Container” Widgets</h4><p>The container widgets have the same methods as the interactive and visual widgets <strong>plus</strong> <code>getContainerNode</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyWidget = photonui.Container.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line">        <span class="comment">// Widget constructor</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// Return the outer HTML element of the widget</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getContainerNode: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// Return the HTML node that will contain the child</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _buildHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Build the HTML here</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Template-for-“Layout”-Widgets"><a href="#Template-for-“Layout”-Widgets" class="headerlink" title="Template for “Layout” Widgets"></a>Template for “Layout” Widgets</h4><p>The layout widgets are the most difficult to build: in addition to <code>getHtml</code> and <code>_buildHtml</code> methods, you have to implement the <code>_updateLayout</code> method which will have to build the HTML that glues children widgets together in the layout.</p>
<p>You can look at the <a href="../ref/files/src_container_layout_boxlayout.js.html#l42"><code>photonui.BoxLayout</code></a> code if you want a simple example of a layout widget.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyWidget = photonui.Layout.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line">        <span class="comment">// Widget constructor...</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// Return the outer HTML element of the widget</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _buildHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Build the base HTML here</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _updateLayout: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Build / Update the HTML layout with the widgets listed in</span></span><br><span class="line">        <span class="comment">// this.children</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Example-Creating-a-Simple-Button-Widget"><a href="#Example-Creating-a-Simple-Button-Widget" class="headerlink" title="Example: Creating a Simple Button Widget"></a>Example: Creating a Simple Button Widget</h3><p>No more theory, let’s build a real widget: a simple button with a <code>text</code> property to define… the button’s text, a <code>click</code> wEvent, and even the internationalisation support.</p>
<h4 id="HTML-and-Basic-Code"><a href="#HTML-and-Basic-Code" class="headerlink" title="HTML and Basic Code"></a>HTML and Basic Code</h4><p>Here we just apply everything we saw before to create the visual part of the button. You can also add a bit of CSS to make it look better, but that’s not the topic.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SimpleButton = photonui.Widget.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.__html.button;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _buildHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.__html.button = <span class="built_in">document</span>.createElement(<span class="string">"button"</span>);</span><br><span class="line">        <span class="keyword">this</span>.__html.button.className = <span class="string">"photonui-widget photonui-simplebutton"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="The-“text”-Property"><a href="#The-“text”-Property" class="headerlink" title="The “text” Property"></a>The “text” Property</h4><p>Then we add our <code>text</code> property that allows to set the button’s text:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">_text: <span class="string">"Button"</span>,</span><br><span class="line"></span><br><span class="line">getText: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._text;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">setText: <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>._text = text;</span><br><span class="line">    photonui.Helpers.cleanNode(<span class="keyword">this</span>.__html.button);</span><br><span class="line">    <span class="keyword">this</span>.__html.button.appendChild(<span class="built_in">document</span>.createTextNode(text));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>NOTE:</strong> The code as we wrote it here works, but if the user never sets the <code>text</code> property, the widget will not display the default text defined in the class (in the <code>_text</code> attribute) since the setter is never called. To force properties to be refreshed even when not set, you must use the <code>@photonui-update</code> annotation:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getText: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="string">"@photonui-update"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._text;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>This abitbol’s annotation can go either in the getter function or in the setter function. It <em>must</em> be at the top of the function code.</p>
<h4 id="Adding-Interactivity-wEvent"><a href="#Adding-Interactivity-wEvent" class="headerlink" title="Adding Interactivity (wEvent)"></a>Adding Interactivity (wEvent)</h4><p>There are two kinds of events to deal with when you build a PhotonUI widget:</p>
<ul>
<li><p>The native javascript events, that will be used only behind the scene by the widget,</p>
</li>
<li><p>and the wEvents, that are exposed through the widget API</p>
</li>
</ul>
<p>So the widget binds native js event to its DOM elements and can expose a corresponding wEvent if required.</p>
<p>First, we have to declare the available wEvents of the widget. This can be done with the <code>_registerWEvents</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">this</span>._registerWEvents([<span class="string">"click"</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then, we have to bind the native javascript <code>click</code> event to the button. To bind native js events, PhotonUI provides an event manager that will automatically unbind the events when the widget is destroyed; you can use it through two methods: <code>_bindEvent</code> and <code>_unbindEvent</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">this</span>._bindEvent(</span><br><span class="line">        <span class="string">"button-click"</span>,       <span class="comment">// id (any string you want, unique in the widget)</span></span><br><span class="line">        <span class="keyword">this</span>.__html.button,   <span class="comment">// HTML element</span></span><br><span class="line">        <span class="string">"click"</span>,              <span class="comment">// Native event name</span></span><br><span class="line">        <span class="keyword">this</span>.__onButtonClicked.bind(<span class="keyword">this</span>)  <span class="comment">// Internal (private) callback</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Finally we create our internal callback that will be in charge of calling the callbacks of our wEvent using the <code>_callCallbacks</code> method:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__onButtonClicked: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>._callCallbacks(</span><br><span class="line">        <span class="string">"click"</span>,   <span class="comment">// wEvent name</span></span><br><span class="line">        [event]    <span class="comment">// List of additionnal params passed to the callbacks</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>NOTE:</strong> The first argument of all the wEvent callbacks is always the widget that called it:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myWEventCallback</span>(<span class="params"> widget [, additionalParam1 [, additionalParam2 [, ...]]] </span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Callback code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="The-Final-Code"><a href="#The-Final-Code" class="headerlink" title="The Final Code"></a>The Final Code</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SimpleButton = photonui.Widget.$extend(&#123;</span><br><span class="line"></span><br><span class="line">    __init__: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//  /!\ WARNING: we have to register wEvents BEFORE calling</span></span><br><span class="line">        <span class="comment">//  the parent constructor, otherwise the declarative syntax will</span></span><br><span class="line">        <span class="comment">//  fail to register the callbacks...</span></span><br><span class="line">        <span class="keyword">this</span>._registerWEvents([<span class="string">"click"</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">super</span>(params);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>._bindEvent(</span><br><span class="line">            <span class="string">"button-click"</span>,</span><br><span class="line">            <span class="keyword">this</span>.__html.button,</span><br><span class="line">            <span class="string">"click"</span>,</span><br><span class="line">            <span class="keyword">this</span>.__onButtonClicked.bind(<span class="keyword">this</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _text: <span class="string">"Button"</span>,</span><br><span class="line"></span><br><span class="line">    getText: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="string">"@photonui-update"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._text;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    setText: <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._text = text;</span><br><span class="line">        photonui.Helpers.cleanNode(<span class="keyword">this</span>.__html.button);</span><br><span class="line">        <span class="keyword">this</span>.__html.button.appendChild(<span class="built_in">document</span>.createTextNode(text));</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.__html.button;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    _buildHtml: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.__html.button = <span class="built_in">document</span>.createElement(<span class="string">"button"</span>);</span><br><span class="line">        <span class="keyword">this</span>.__html.button.className = <span class="string">"photonui-widget photonui-simplebutton"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    __onButtonClicked: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._callCallbacks(<span class="string">"click"</span>, [event]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// A bit of code to test our widget</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="keyword">new</span> SimpleButton(&#123;</span><br><span class="line">    text: <span class="string">"My First Widget"</span>,</span><br><span class="line">    callbacks: &#123;</span><br><span class="line">        click: <span class="function"><span class="keyword">function</span>(<span class="params">widget, event</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">"Button clicked!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">photonui.domInsert(btn, <span class="string">"demo"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Here-We-Are"><a href="#Here-We-Are" class="headerlink" title="Here We Are"></a>Here We Are</h3><p>Voilà, you created your first PhotonUI widget. Not too difficult right ? ;)</p>

    </article>
</div>


        </div>

        <footer id="footer">
    <p>
        Copyright (c)  2014-2024 Wanadev
         - <a href="http://www.wanadev.fr">www.wanadev.fr</a><br />
        Unless otherwise specified, all content of this site is published under the
        <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en">cc by-sa 3.0</a> license
    </p>
</footer>


    </body>

</html>

