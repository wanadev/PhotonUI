<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/nonvisual/mousemanager.js - photonui</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="photonui" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.8.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/photonui.AccelManager.html">photonui.AccelManager</a></li>
                                <li><a href="../classes/photonui.Base.html">photonui.Base</a></li>
                                <li><a href="../classes/photonui.BaseIcon.html">photonui.BaseIcon</a></li>
                                <li><a href="../classes/photonui.BaseWindow.html">photonui.BaseWindow</a></li>
                                <li><a href="../classes/photonui.BoxLayout.html">photonui.BoxLayout</a></li>
                                <li><a href="../classes/photonui.Button.html">photonui.Button</a></li>
                                <li><a href="../classes/photonui.Canvas.html">photonui.Canvas</a></li>
                                <li><a href="../classes/photonui.CheckBox.html">photonui.CheckBox</a></li>
                                <li><a href="../classes/photonui.Color.html">photonui.Color</a></li>
                                <li><a href="../classes/photonui.ColorButton.html">photonui.ColorButton</a></li>
                                <li><a href="../classes/photonui.ColorPalette.html">photonui.ColorPalette</a></li>
                                <li><a href="../classes/photonui.ColorPicker.html">photonui.ColorPicker</a></li>
                                <li><a href="../classes/photonui.ColorPickerDialog.html">photonui.ColorPickerDialog</a></li>
                                <li><a href="../classes/photonui.Container.html">photonui.Container</a></li>
                                <li><a href="../classes/photonui.DataView.html">photonui.DataView</a></li>
                                <li><a href="../classes/photonui.Dialog.html">photonui.Dialog</a></li>
                                <li><a href="../classes/photonui.Expander.html">photonui.Expander</a></li>
                                <li><a href="../classes/photonui.FAIcon.html">photonui.FAIcon</a></li>
                                <li><a href="../classes/photonui.Field.html">photonui.Field</a></li>
                                <li><a href="../classes/photonui.FileManager.html">photonui.FileManager</a></li>
                                <li><a href="../classes/photonui.FluidLayout.html">photonui.FluidLayout</a></li>
                                <li><a href="../classes/photonui.FluidView.html">photonui.FluidView</a></li>
                                <li><a href="../classes/photonui.FontSelect.html">photonui.FontSelect</a></li>
                                <li><a href="../classes/photonui.GridLayout.html">photonui.GridLayout</a></li>
                                <li><a href="../classes/photonui.Helpers.html">photonui.Helpers</a></li>
                                <li><a href="../classes/photonui.IconButton.html">photonui.IconButton</a></li>
                                <li><a href="../classes/photonui.IconView.html">photonui.IconView</a></li>
                                <li><a href="../classes/photonui.Image.html">photonui.Image</a></li>
                                <li><a href="../classes/photonui.KeyboardManager.html">photonui.KeyboardManager</a></li>
                                <li><a href="../classes/photonui.Label.html">photonui.Label</a></li>
                                <li><a href="../classes/photonui.Layout.html">photonui.Layout</a></li>
                                <li><a href="../classes/photonui.ListView.html">photonui.ListView</a></li>
                                <li><a href="../classes/photonui.Menu.html">photonui.Menu</a></li>
                                <li><a href="../classes/photonui.MenuItem.html">photonui.MenuItem</a></li>
                                <li><a href="../classes/photonui.MouseManager.html">photonui.MouseManager</a></li>
                                <li><a href="../classes/photonui.NumericField.html">photonui.NumericField</a></li>
                                <li><a href="../classes/photonui.PopupMenu.html">photonui.PopupMenu</a></li>
                                <li><a href="../classes/photonui.PopupWindow.html">photonui.PopupWindow</a></li>
                                <li><a href="../classes/photonui.ProgressBar.html">photonui.ProgressBar</a></li>
                                <li><a href="../classes/photonui.Select.html">photonui.Select</a></li>
                                <li><a href="../classes/photonui.Separator.html">photonui.Separator</a></li>
                                <li><a href="../classes/photonui.Slider.html">photonui.Slider</a></li>
                                <li><a href="../classes/photonui.SpriteIcon.html">photonui.SpriteIcon</a></li>
                                <li><a href="../classes/photonui.SpriteSheet.html">photonui.SpriteSheet</a></li>
                                <li><a href="../classes/photonui.SubMenuItem.html">photonui.SubMenuItem</a></li>
                                <li><a href="../classes/photonui.Switch.html">photonui.Switch</a></li>
                                <li><a href="../classes/photonui.TabItem.html">photonui.TabItem</a></li>
                                <li><a href="../classes/photonui.TabLayout.html">photonui.TabLayout</a></li>
                                <li><a href="../classes/photonui.TableView.html">photonui.TableView</a></li>
                                <li><a href="../classes/photonui.Template.html">photonui.Template</a></li>
                                <li><a href="../classes/photonui.Text.html">photonui.Text</a></li>
                                <li><a href="../classes/photonui.TextAreaField.html">photonui.TextAreaField</a></li>
                                <li><a href="../classes/photonui.TextField.html">photonui.TextField</a></li>
                                <li><a href="../classes/photonui.ToggleButton.html">photonui.ToggleButton</a></li>
                                <li><a href="../classes/photonui.Translation.html">photonui.Translation</a></li>
                                <li><a href="../classes/photonui.Viewport.html">photonui.Viewport</a></li>
                                <li><a href="../classes/photonui.Widget.html">photonui.Widget</a></li>
                                <li><a href="../classes/photonui.Window.html">photonui.Window</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Composite.html">Composite</a></li>
                                <li><a href="../modules/Container.html">Container</a></li>
                                <li><a href="../modules/DataView.html">DataView</a></li>
                                <li><a href="../modules/Helpers.html">Helpers</a></li>
                                <li><a href="../modules/Interactive.html">Interactive</a></li>
                                <li><a href="../modules/Layout.html">Layout</a></li>
                                <li><a href="../modules/NonVisual.html">NonVisual</a></li>
                                <li><a href="../modules/PhotonUI.html">PhotonUI</a></li>
                                <li><a href="../modules/Visual.html">Visual</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/nonvisual/mousemanager.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * Copyright (c) 2014-2015, Wanadev &lt;http://www.wanadev.fr/&gt;
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *   * Redistributions of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 *   * Redistributions in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 *   * Neither the name of Wanadev nor the names of its contributors may be used
 *     to endorse or promote products derived from this software without specific
 *     prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Authored by: Fabien LOISON &lt;http://flozz.fr/&gt;
 */

/**
 * PhotonUI - Javascript Web User Interface.
 *
 * @module PhotonUI
 * @submodule NonVisual
 * @namespace photonui
 */

var Helpers = require(&quot;../helpers.js&quot;);
var Base = require(&quot;../base.js&quot;);
var Widget = require(&quot;../widget.js&quot;);

/**
 * Manage advanced mouse events on Widgets or HTMLElements.
 *
 * wEvents:
 *
 *   * mouse-event:
 *      - description: Called for *ALL* mouse events.
 *      - callback:    function(manager, mstate)
 *
 *   * mouse-down:
 *      - description: Mouse button pressed.
 *      - callback:    function(manager, mstate)
 *
 *   * mouse-up:
 *      - description: Mouse button released.
 *      - callback:    function(manager, mstate)
 *
 *   * click:
 *      - description: Click...
 *      - callback:    function(manager, mstate)
 *
 *   * double-click:
 *      - description: Double click...
 *      - callback:    function(manager, mstate)
 *
 *   * drag-start:
 *      - description: Start dragging.
 *      - callback:    function(manager, mstate)
 *
 *   * dragging:
 *      - description: dragging.
 *      - callback:    function(manager, mstate)
 *
 *   * drag-end:
 *      - description: Stop dragging.
 *      - callback:    function(manager, mstate)
 *
 *   * mouse-move:
 *      - description: Mouse move on the element.
 *      - callback:    function(manager, mstate)
 *
 *   * scroll-up:
 *      - description: Scroll up.
 *      - callback:    function(manager, mstate)
 *
 *   * scroll-down:
 *      - description: Scroll down.
 *      - callback:    function(manager, mstate)
 *
 *
 * mstate:
 *
 *   A snapshot of the mouse state ath the moment when the event occured.
 *
 *     {
 *         event: &lt;Object&gt;,       // The original js event
 *         action: &lt;String&gt;,      // The event name (mouse-down/up/move, click, double-click,
 *                                //    drag-start/end, dragging, scroll-up/down)
 *         pageX: &lt;Number&gt;,       // X position, relative to page top-left corner.
 *         pageY: &lt;Number&gt;,       // Y position, relative to page top-left corner.
 *         x: &lt;Number&gt;,           // X position, relative to the HTML element.
 *         y: &lt;Number&gt;,           // Y position, relative to the HTML element.
 *         deltaX: &lt;Number&gt;,      // Delta X (current_x - previous_x)
 *         deltaY: &lt;Number&gt;,      // Delta Y (current_y - previous_y)
 *         btnLeft: &lt;Boolean&gt;,    // Current state of the mouse left button.
 *         btnMiddle: &lt;Boolean&gt;,  // Current state of the mouse middle button.
 *         btnRight: &lt;Boolean&gt;,   // Current state of the mouse right button.
 *         button: &lt;String&gt;       // The button that triggered the last event (none, &quot;left&quot;, &quot;middle&quot;, &quot;right&quot;).
 *     }
 *
 * @class MouseManager
 * @constructor
 * @extends photonui.Base
 * @param {photonui.Widget} element Any PhotonUI Widget (optional).
 * @param {HTMLElement} element Any HTML element (optional).
 * @param {Object} params additional params (optional).
 */
var MouseManager = Base.$extend({

    // Constructor
    __init__: function (element, params) {
        this._registerWEvents([
            &quot;mouse-event&quot;, &quot;mouse-down&quot;, &quot;mouse-up&quot;, &quot;click&quot;, &quot;double-click&quot;,
            &quot;drag-start&quot;, &quot;dragging&quot;, &quot;drag-end&quot;, &quot;mouse-move&quot;, &quot;scroll-up&quot;,
            &quot;scroll-down&quot;
        ]);
        if (element &amp;&amp; (element instanceof Widget || element instanceof HTMLElement)) {
            this.$super(params);
            this.element = element;
        } else {
            this.$super(element);
        }
    },

    //////////////////////////////////////////
    // Properties and Accessors             //
    //////////////////////////////////////////

    // ====== Public properties ======

    /**
     * The HTML Element on which the events are binded.
     *
     * NOTE: If a photonui.Widget object is assigned to this property,
     *       its HTML Element will be automatically assigned to the property instead.
     *
     * @property element
     * @type HTMLElement
     * @default null
     */
    _element: null,

    getElement: function () {
        return this._element || document;
    },

    setElement: function (element) {
        if (element instanceof Widget) {
            this._element = element.interactiveNode || element.html;
        } else if (element instanceof HTMLElement) {
            this._element = element;
        } else {
            this._element = null;
        }
        this._updateEvents();
    },

    /**
     * Minimum distance for triggering a drag-start, and maximum distance
     * to consider a mouse down/up as a click.
     *
     * @property threshold
     * @type Number
     * @default 5
     */
    _threshold: 5,

    getThreshold: function () {
        return this._threshold;
    },

    setThreshold: function (threshold) {
        this._threshold = threshold;
    },

    /**
     * Scale all position events by a factor. Use it when the canvas is scaled.
     *
     * @property scaleX
     * @type Number
     * @default 1
     */
    _scaleX: 1,

    getScaleX: function () {
        return this._scaleX;
    },

    setScaleX: function (scaleX) {
        this._scaleX = scaleX;
    },

    /**
     * Scale all position events by a factor. Use it when the canvas is scaled.
     *
     * @property scaleY
     * @type Number
     * @default 1
     */
    _scaleY: 1,

    getScaleY: function () {
        return this._scaleY;
    },

    setScaleY: function (scaleY) {
        this._scaleY = scaleY;
    },

    /**
     * Translate all position events by a scalar. Use it when the canvas is translated.
     *
     * @property translateX
     * @type Number
     * @default 0
     */
    _translateX: 0,

    getTranslateX: function () {
        return this._translateX;
    },

    setTranslateX: function (translateX) {
        this._translateX = translateX;
    },

    /**
     * Translate all position events by a scalar. Use it when the canvas is translated.
     *
     * @property translateY
     * @type Number
     * @default 0
     */
    _translateY: 0,

    getTranslateY: function () {
        return this._translateY;
    },

    setTranslateY: function (translateY) {
        this._translateY = translateY;
    },

    /**
     * X position, relative to page top-left corner.
     *
     * @property pageX
     * @readOnly
     * @type Number
     * @default 0
     */
    getPageX: function () {
        return this.__event.pageX || 0;
    },

    /**
     * Y position, relative to page top-left corner.
     *
     * @property pageY
     * @readOnly
     * @type Number
     * @default 0
     */
    getPageY: function () {
        return this.__event.pageY || 0;
    },

    /**
     * X position, relative to the HTML element.
     *
     * @property x
     * @readOnly
     * @type Number
     */
    getX: function () {
        var ex = Helpers.getAbsolutePosition(this.element).x;
        return (this.pageX - ex) * this.scaleX + this.translateX;
    },

    /**
     * Y position, relative to the HTML element.
     *
     * @property y
     * @readOnly
     * @type Number
     */
    getY: function () {
        var ey = Helpers.getAbsolutePosition(this.element).y;
        return (this.pageY - ey) * this.scaleY + this.translateY;
    },

    /**
     * Delta X (current_x - previous_x).
     *
     * @property deltaX
     * @readOnly
     * @type Number
     */
    getDeltaX: function () {
        return (this.pageX - ((this.__prevState.pageX !== undefined) ?
            this.__prevState.pageX : this.pageX)) * this.scaleX;
    },

    /**
     * Delta Y (current_y - previous_y).
     *
     * @property deltaY
     * @readOnly
     * @type Number
     */
    getDeltaY: function () {
        return (this.pageY - ((this.__prevState.pageY !== undefined) ?
            this.__prevState.pageY : this.pageY)) * this.scaleY;
    },

    /**
     * The action:
     *
     *   * &quot;mouse-down&quot;
     *   * &quot;moues-up&quot;
     *   * &quot;click&quot;
     *   * &quot;double-click&quot;
     *   * &quot;drag-start&quot;
     *   * &quot;dragging&quot;
     *   * &quot;drag-end&quot;
     *   * &quot;scroll-down&quot;
     *   * &quot;scroll-up&quot;
     *   * &quot;mouse-move&quot;
     *
     * @property action
     * @readOnly
     * @type String
     */
    _action: &quot;&quot;,

    getAction: function () {
        return this._action;
    },

    /**
     * Current state of the mouse left button.
     *
     * @property btnLeft
     * @type Boolean
     * @readOnly
     */
    _btnLeft: false,

    getBtnLeft: function () {
        return this._btnLeft;
    },

    /**
     * Current state of the mouse middle button.
     *
     * @property btnMiddle
     * @type Boolean
     * @readOnly
     */
    _btnMiddle: false,

    getBtnMiddle: function () {
        return this._btnMiddle;
    },

    /**
     * Current state of the mouse right button.
     *
     * @property btnRight
     * @type Boolean
     * @readOnly
     */
    _btnRight: false,

    getBtnRight: function () {
        return this._btnRight;
    },

    /**
     * The button that triggered the last event.
     *
     *   * none
     *   * &quot;left&quot;
     *   * &quot;middle&quot;
     *   * &quot;right&quot;
     *
     * @property button
     * @readOnly
     * @type String
     */
    _button: null,

    getButton: function () {
        return this._button;
    },

    // ====== Private properties ======

    /**
     * Previous state.
     *
     * @property __prevState
     * @private
     * @type Object
     */
    __prevState: {},

    /**
     * Js event on mouse down.
     *
     * @property __mouseDownEvent
     * @private
     * @type Object
     */
    __mouseDownEvent: {},

    /**
     * Last event object.
     *
     * @property __event
     * @private
     * @type Object
     * @default {}
     */
    __event: {},

    /**
     * The button that triggered the drag start event
     *
     *   * null
     *   * &quot;left&quot;
     *   * &quot;middle&quot;
     *   * &quot;right&quot;
     *
     * @property __dragStartButton
     * @private
     * @type String
     * @default null
     */
    __dragStartButton: null,

    //////////////////////////////////////////
    // Methods                              //
    //////////////////////////////////////////

    /**
     * Bind events on the HTML Element.
     *
     * @method _updateEvents
     * @private
     */
    _updateEvents: function () {
        // Unbind all existing events
        for (var id in this.__events) {
            this._unbindEvent(id);
        }
        // Check if we have an html element
        if (!this.element) {
            return;
        }
        // Bind new events
        this._bindEvent(&quot;mouse-down&quot;, this.element, &quot;mousedown&quot;, this.__onMouseDown.bind(this));
        this._bindEvent(&quot;mouse-up&quot;, this.element, &quot;mouseup&quot;, this.__onMouseUp.bind(this));
        this._bindEvent(&quot;double-click&quot;, this.element, &quot;dblclick&quot;, this.__onDoubleClick.bind(this));
        this._bindEvent(&quot;mouse-move&quot;, this.element, &quot;mousemove&quot;, this.__onMouseMove.bind(this));
        this._bindEvent(&quot;wheel&quot;, this.element, &quot;wheel&quot;, this.__onWheel.bind(this));

        this._bindEvent(&quot;document-mouse-up&quot;, document, &quot;mouseup&quot;, this.__onDocumentMouseUp.bind(this));
        this._bindEvent(&quot;document-mouse-move&quot;, document, &quot;mousemove&quot;, this.__onDocumentMouseMove.bind(this));
    },

    /**
     * Take a snapshot of the MouseManager
     *
     * @method _dump
     * @private
     * @return {Object}
     */
    _dump: function () {
        return {
            event: this.__event,
            action: this.action,
            pageX: this.pageX,
            pageY: this.pageY,
            x: this.x,
            y: this.y,
            deltaX: this.deltaX,
            deltaY: this.deltaY,
            btnLeft: this.btnLeft,
            btnMiddle: this.btnMiddle,
            btnRight: this.btnRight,
            button: this.button
        };
    },

    /**
     * Analyze and dispatche wEvents.
     *
     * @method _stateMachine
     * @private
     * @param {String} action The action name (e.g. &quot;mouse-up&quot;).
     * @param {Object} event The js event.
     */
    _stateMachine: function (action, event) {
        // Save the previous state
        this.__prevState = this._dump();

        // Load the current state
        this._action = action;
        this.__event = event;
        this._button = null;
        if (this.__dragStartButton) {
            this._button = this.__dragStartButton;
        } else if (event.button === 0) {
            this._button = &quot;left&quot;;
        } else if (event.button === 1) {
            this._button = &quot;middle&quot;;
        } else if (event.button === 2) {
            this._button = &quot;right&quot;;
        }

        // Analyze the event

        // Mouse Down / Mouse Up
        if (action == &quot;mouse-down&quot;) {
            this.__mouseDownEvent = event;

            if (event.button === 0) {
                this._btnLeft = true;
            }
            if (event.button === 1) {
                this._btnMiddle = true;
            }
            if (event.button === 2) {
                this._btnRight = true;
            }

            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        } else if (action == &quot;mouse-up&quot;) {
            if (event.button === 0) {
                this._btnLeft = false;
            }
            if (event.button === 1) {
                this._btnMiddle = false;
            }
            if (event.button === 2) {
                this._btnRight = false;
            }

            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        } else if (action == &quot;drag-end&quot;) {
            if (event.button === 0) {
                this._btnLeft = false;
            }
            if (event.button === 1) {
                this._btnMiddle = false;
            }
            if (event.button === 2) {
                this._btnRight = false;
            }
        }

        // Click
        if (action == &quot;mouse-up&quot; &amp;&amp; (Math.abs(this.pageX - this.__mouseDownEvent.pageX) &lt;= this._threshold &amp;&amp;
            Math.abs(this.pageY - this.__mouseDownEvent.pageY) &lt;= this._threshold)) {
            this._action = &quot;click&quot;;
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(&quot;click&quot;, [this._dump()]);
        }

        // Double Click
        if (action == &quot;double-click&quot; &amp;&amp; this.__prevState.action == &quot;click&quot;) {
            this._action = &quot;double-click&quot;;
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        }

        // Mouse move
        if (action == &quot;mouse-move&quot;) {
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        }

        // Drag Start
        if (action == &quot;mouse-move&quot; &amp;&amp; this.__prevState.action != &quot;drag-start&quot; &amp;&amp;
            this.__prevState.action != &quot;dragging&quot; &amp;&amp; (this.btnLeft || this.btnMiddle || this.btnRight)) {
            if (Math.abs(this.pageX - this.__mouseDownEvent.pageX) &gt; this._threshold ||
                Math.abs(this.pageY - this.__mouseDownEvent.pageY) &gt; this._threshold) {
                this.__dragStartButton = this._button;
                // Drag Start
                this._action = &quot;drag-start&quot;;
                this.__event = this.__mouseDownEvent;
                this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
                this._callCallbacks(this.action, [this._dump()]);
                // Dragging
                this._action = &quot;dragging&quot;;
                this.__prevState.event = this.__mouseDownEvent;
                this.__event = event;
                this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
                this._callCallbacks(this.action, [this._dump()]);
            }

        // Dragging
        } else if (action == &quot;dragging&quot; || (action == &quot;mouse-move&quot; &amp;&amp; (this.__prevState.action == &quot;drag-start&quot; ||
                 this.__prevState.action == &quot;dragging&quot;) &amp;&amp; (this.btnLeft || this.btnMiddle || this.btnRight))) {
            this._action = &quot;dragging&quot;;
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);

        // Drag End
        } else if (action == &quot;drag-end&quot; || (action == &quot;mouse-up&quot; &amp;&amp; (this.__prevState.action == &quot;dragging&quot; ||
                 this.__prevState.action == &quot;drag-start&quot;) &amp;&amp; !(this.btnLeft || this.btnMiddle || this.btnRight))) {
            this._action = &quot;drag-end&quot;;
            this.__dragStartButton = null;
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        }

        // Scroll Up / Scroll Down
        if (action == &quot;scroll-up&quot; || action == &quot;scroll-down&quot;) {
            this._callCallbacks(&quot;mouse-event&quot;, [this._dump()]);
            this._callCallbacks(this.action, [this._dump()]);
        }
    },

    //////////////////////////////////////////
    // Internal Events Callbacks            //
    //////////////////////////////////////////

    /**
     * @method __onMouseDown
     * @private
     * @param event
     */
    __onMouseDown: function (event) {
        this._stateMachine(&quot;mouse-down&quot;, event);
    },

    /**
     * @method __onMouseUp
     * @private
     * @param event
     */
    __onMouseUp: function (event) {
        this._stateMachine(&quot;mouse-up&quot;, event);
    },

    /**
     * @method __onDoubleClick
     * @private
     * @param event
     */
    __onDoubleClick: function (event) {
        this._stateMachine(&quot;double-click&quot;, event);
    },

    /**
     * @method __onMouseMove
     * @private
     * @param event
     */
    __onMouseMove: function (event) {
        this._stateMachine(&quot;mouse-move&quot;, event);
    },

    /**
     * Used to detect drag-end outside the element.
     *
     * @method __onDocumentMouseUp
     * @private
     * @param event
     */
    __onDocumentMouseUp: function (event) {
        if (event.target === this._element) {
            return;
        }
        if (this.action == &quot;dragging&quot; || this.action == &quot;drag-start&quot;) {
            this._stateMachine(&quot;drag-end&quot;, event);
        } else if (event.button === 0 &amp;&amp; this._btnLeft ||
            event.button === 1 &amp;&amp; this._btnMiddle ||
            event.button === 2 &amp;&amp; this._btnRight) {

            this._stateMachine(&quot;mouse-up&quot;, event);
        }
    },

    /**
     * Used to detect dragging outside the element.
     *
     * @method __onDocumentMouseMove
     * @private
     * @param event
     */
    __onDocumentMouseMove: function (event) {
        if (event.target === this._element) {
            return;
        }
        if (this.action == &quot;dragging&quot; || this.action == &quot;drag-start&quot;) {
            this._stateMachine(&quot;dragging&quot;, event);
        }
    },

    /**
     * @method __onWheel
     * @private
     * @param event
     */
    __onWheel: function (event) {
        var wheelDelta = null;

        if (event.deltaY !== undefined) {
            wheelDelta = -event.deltaY;
        }

        if (wheelDelta !== null) {
            if (wheelDelta &gt;= 0) {
                this._stateMachine(&quot;scroll-up&quot;, event);
            } else {
                this._stateMachine(&quot;scroll-down&quot;, event);
            }
        }
    }
});

module.exports = MouseManager;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
